# ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –ø–ª–∞—Ç–µ–∂–µ–π - –ì–û–¢–û–í–û!

## üêõ –ü—Ä–æ–±–ª–µ–º–∞
–ü—Ä–∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–∏ –æ–ø–ª–∞—Ç—ã –∏–≥—Ä–æ–∫–∞ –≤–æ–∑–Ω–∏–∫–∞–ª–∞ –æ—à–∏–±–∫–∞:
```
column "payment_status" of relation "game_registrations" does not exist
```

## üîç –ü—Ä–∏—á–∏–Ω–∞
–ö–æ–¥ –ø—ã—Ç–∞–ª—Å—è –æ–±–Ω–æ–≤–∏—Ç—å –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –∫–æ–ª–æ–Ω–∫—É `payment_status` –≤ —Ç–∞–±–ª–∏—Ü–µ `game_registrations`.

## ‚úÖ –†–µ—à–µ–Ω–∏–µ
–£–¥–∞–ª–µ–Ω–æ –ø–æ–ª–µ `payment_status` –∏–∑ –≤—Å–µ—Ö SQL-–∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –º–æ–¥–µ–ª–∏ `Game.js`:

### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã:

#### 1. `confirmPayment()` - –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –æ–ø–ª–∞—Ç—ã
**–ë—ã–ª–æ:**
```sql
UPDATE game_registrations
SET status = 'paid',
    payment_status = 'paid',  ‚ùå
    payment_amount = $1,
    ...
```

**–°—Ç–∞–ª–æ:**
```sql
UPDATE game_registrations
SET status = 'paid',
    payment_amount = $1,
    ...
```

#### 2. `onsiteRegistration()` - –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–∞ –º–µ—Å—Ç–µ
**UPDATE —á–∞—Å—Ç—å:**
```sql
UPDATE game_registrations
SET status = 'paid',
    payment_status = 'paid',  ‚ùå –£–î–ê–õ–ï–ù–û
    payment_amount = $1,
    ...
```

**INSERT —á–∞—Å—Ç—å:**
```sql
INSERT INTO game_registrations 
(game_id, user_id, status, payment_status, ‚ùå –£–î–ê–õ–ï–ù–û
 payment_amount, payment_method, ...)
VALUES ($1, $2, 'paid', 'paid', ‚ùå –£–î–ê–õ–ï–ù–û
        $3, $4, ...)
```

#### 3. `lateRegistration()` - –ü–æ–∑–¥–Ω—è—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
**INSERT —á–∞—Å—Ç—å:**
```sql
INSERT INTO game_registrations 
(game_id, user_id, status, payment_status, ‚ùå –£–î–ê–õ–ï–ù–û
 payment_amount, ...)
VALUES ($1, $2, 'paid', 'paid', ‚ùå –£–î–ê–õ–ï–ù–û
        $3, $4, ...)
```

**UPDATE —á–∞—Å—Ç—å (ON CONFLICT):**
```sql
ON CONFLICT (game_id, user_id) DO UPDATE
SET status = 'paid',
    payment_status = 'paid',  ‚ùå –£–î–ê–õ–ï–ù–û
    payment_amount = $3,
    ...
```

---

## üìä –ß—Ç–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤–º–µ—Å—Ç–æ payment_status

**–î–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞ –æ–ø–ª–∞—Ç—ã –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–æ–ª–µ `status`:**

```javascript
// –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–ø–ª–∞—Ç—ã
if (registration.status === 'paid') {
  // –ò–≥—Ä–æ–∫ –æ–ø–ª–∞—Ç–∏–ª
}

if (registration.status === 'registered') {
  // –û–∂–∏–¥–∞–µ—Ç –æ–ø–ª–∞—Ç—ã
}
```

**–î–æ—Å—Ç—É–ø–Ω—ã–µ —Å—Ç–∞—Ç—É—Å—ã:**
- `registered` - –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω, –∂–¥–µ—Ç –æ–ø–ª–∞—Ç—ã
- `paid` - –û–ø–ª–∞—Ç–∏–ª
- `playing` - –ò–≥—Ä–∞–µ—Ç
- `eliminated` - –í—ã–±—ã–ª
- `finished` - –ó–∞–≤–µ—Ä—à–∏–ª –∏–≥—Ä—É
- `no_show` - –ù–µ —è–≤–∏–ª—Å—è

---

## üéØ –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–¥–µ

### –§–∞–π–ª: `server/models/Game.js`

**–ú–µ—Ç–æ–¥—ã, –≤ –∫–æ—Ç–æ—Ä—ã—Ö —É–¥–∞–ª–µ–Ω–æ `payment_status`:**
1. ‚úÖ `confirmPayment()` - —Å—Ç—Ä–æ–∫–∞ 604 (–±—ã–ª–æ)
2. ‚úÖ `onsiteRegistration()` - —Å—Ç—Ä–æ–∫–∏ 769, 784-785 (–±—ã–ª–æ)
3. ‚úÖ `lateRegistration()` - —Å—Ç—Ä–æ–∫–∏ 835, 841 (–±—ã–ª–æ)

**–í—Å–µ–≥–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:** 5 –º–µ—Å—Ç

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:

### 1. –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –æ–ø–ª–∞—Ç—ã
```
‚úÖ –ü–∞–Ω–µ–ª—å –ø—Ä–∏–µ–º–∞ –∏–≥—Ä–æ–∫–æ–≤
‚úÖ –ù–∞–π—Ç–∏ –∏–≥—Ä–æ–∫–∞ —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º "–û–∂–∏–¥–∞–µ—Ç –æ–ø–ª–∞—Ç—ã"
‚úÖ –ù–∞–∂–∞—Ç—å "–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –æ–ø–ª–∞—Ç—É"
‚úÖ –ó–∞–ø–æ–ª–Ω–∏—Ç—å —Å—É–º–º—É –∏ —Å–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã
‚úÖ –ù–∞–∂–∞—Ç—å "–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å"
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –°—Ç–∞—Ç—É—Å –º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ "–û–ø–ª–∞—Ç–∏–ª" (–∑–µ–ª–µ–Ω—ã–π badge)
- ‚úÖ –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Å—É–º–º–∞ –æ–ø–ª–∞—Ç—ã
- ‚úÖ –ö–Ω–æ–ø–∫–∏ –º–µ–Ω—è—é—Ç—Å—è –Ω–∞ –≥–∞–ª–æ—á–∫—É
- ‚úÖ Toast: "–û–ø–ª–∞—Ç–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞ –¥–ª—è [–ò–º—è]"

### 2. –ò—Å–∫–ª—é—á–µ–Ω–∏–µ –∏–≥—Ä–æ–∫–∞
```
‚úÖ –ù–∞–∂–∞—Ç—å –∫–Ω–æ–ø–∫—É "–ò—Å–∫–ª—é—á–∏—Ç—å" (X)
‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –¥–µ–π—Å—Ç–≤–∏–µ
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –°—Ç–∞—Ç—É—Å –º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ "–ò—Å–∫–ª—é—á–µ–Ω" (–∫—Ä–∞—Å–Ω—ã–π badge)
- ‚úÖ Toast: "[–ò–º—è] –∏—Å–∫–ª—é—á–µ–Ω"

### 3. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–≥—Ä–æ–∫–∞
```
‚úÖ –ù–∞–π—Ç–∏ –∏—Å–∫–ª—é—á–µ–Ω–Ω–æ–≥–æ –∏–≥—Ä–æ–∫–∞
‚úÖ –ù–∞–∂–∞—Ç—å "–í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å"
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –°—Ç–∞—Ç—É—Å –º–µ–Ω—è–µ—Ç—Å—è –æ–±—Ä–∞—Ç–Ω–æ –Ω–∞ "–û–∂–∏–¥–∞–µ—Ç –æ–ø–ª–∞—Ç—ã"
- ‚úÖ Toast: "[–ò–º—è] –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω"

---

## üìù –î–ª—è –¥–µ–ø–ª–æ—è

```bash
# –ó–∞–∫–æ–º–º–∏—Ç–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
git add server/models/Game.js
git commit -m "Fix: remove payment_status column from SQL queries"
git push

# –ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è –Ω–∞ Render (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏: Dashboard ‚Üí Service ‚Üí Logs
```

---

## üéâ –†–µ–∑—É–ª—å—Ç–∞—Ç

–¢–µ–ø–µ—Ä—å –≤—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –ø–ª–∞—Ç–µ–∂–∞–º–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ:
- ‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –æ–ø–ª–∞—Ç—ã
- ‚úÖ –ò—Å–∫–ª—é—á–µ–Ω–∏–µ –∏–≥—Ä–æ–∫–∞
- ‚úÖ –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–≥—Ä–æ–∫–∞
- ‚úÖ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–∞ –º–µ—Å—Ç–µ
- ‚úÖ –ü–æ–∑–¥–Ω—è—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è

---

## üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞–±–ª–∏—Ü—ã game_registrations

**–ü–æ–ª—è, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å –æ–ø–ª–∞—Ç–æ–π:**
```sql
status              VARCHAR(50)   -- 'registered', 'paid', 'playing', etc.
payment_amount      DECIMAL       -- –°—É–º–º–∞ –æ–ø–ª–∞—Ç—ã
payment_method      VARCHAR(50)   -- 'cash', 'card', 'transfer'
payment_confirmed_by INTEGER      -- ID –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
paid_at             TIMESTAMP     -- –í—Ä–µ–º—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –æ–ø–ª–∞—Ç—ã
```

**‚ùå –ù–ï –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è:** `payment_status` (—É–¥–∞–ª–µ–Ω–æ)

---

## üîß –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –æ—Ç–ª–∞–¥–∫–∞

–ï—Å–ª–∏ –ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤—Å—ë –µ—â—ë –µ—Å—Ç—å –ø—Ä–æ–±–ª–µ–º—ã, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏:

**–í –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞ (F12):**
```javascript
Confirming payment: { gameId, userId, amount, ... }
Payment confirmed: { message, registration }
```

**–ù–∞ —Å–µ—Ä–≤–µ—Ä–µ (Render Logs):**
```
Confirm payment request: { ... }
Admin found: 1
Calling Game.confirmPayment...
Payment confirmed successfully: { ... }
```

---

## ‚ú® –°—Ç–∞—Ç—É—Å: –ì–û–¢–û–í–û –ö –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Æ

–í—Å–µ –æ—à–∏–±–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã. –°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç—É—Ä–Ω–∏—Ä–Ω—ã–º–∏ –ø–ª–∞—Ç–µ–∂–∞–º–∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞!

