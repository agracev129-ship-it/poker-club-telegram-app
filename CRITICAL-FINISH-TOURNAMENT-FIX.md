# ‚úÖ –ö–†–ò–¢–ò–ß–ï–°–ö–û–ï –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ: –ø–∞–¥–µ–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ç—É—Ä–Ω–∏—Ä–∞

## üêõ –ü—Ä–æ–±–ª–µ–º–∞

**–°–∏–º–ø—Ç–æ–º—ã:**
- –ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ç—É—Ä–Ω–∏—Ä–∞ –≤—Å–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é –ª–æ–º–∞–µ—Ç—Å—è
- –ù–∏—á–µ–≥–æ –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è
- –û—á–∫–∏ –Ω–µ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –∏–≥—Ä–æ–∫–∞–º –≤ —Ä–µ–π—Ç–∏–Ω–≥–µ
- –¢—É—Ä–Ω–∏—Ä –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ –∏—Å—Ç–æ—Ä–∏–∏

**–ü—Ä–∏—á–∏–Ω–∞:**
- –ú–µ—Ç–æ–¥ `updateRankings()` –ø–∞–¥–∞–ª —Å –æ—à–∏–±–∫–æ–π, –µ—Å–ª–∏ —Ç–∞–±–ª–∏—Ü–∞ `user_stats` –Ω–µ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–ª–∞ –∏–ª–∏ –±—ã–ª–∞ –ø—É—Å—Ç–∞
- –û—à–∏–±–∫–∞ –ø—Ä–æ–±—Ä–∞—Å—ã–≤–∞–ª–∞—Å—å –∏ –ø–∞–¥–∞–ª–æ –≤—Å–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
- –°—Ç–∞—Ç—É—Å —Ç—É—Ä–Ω–∏—Ä–∞ –Ω–µ –æ–±–Ω–æ–≤–ª—è–ª—Å—è, –µ—Å–ª–∏ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏–ª–∞ –æ—à–∏–±–∫–∞
- –û—à–∏–±–∫–∏ –≤ –æ–±—Ä–∞–±–æ—Ç–∫–µ –∏–≥—Ä–æ–∫–æ–≤ –º–æ–≥–ª–∏ –ø–∞–¥–∞—Ç—å –≤–µ—Å—å —Å–µ—Ä–≤–µ—Ä

---

## ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 1. –£–ª—É—á—à–µ–Ω –º–µ—Ç–æ–¥ `updateRankings` - –±–µ–∑–æ–ø–∞—Å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

**–§–∞–π–ª:** `server/models/User.js`

**–ë—ã–ª–æ:**
```javascript
async updateRankings() {
  await query(
    `UPDATE user_stats us
     SET current_rank = ranked.rank
     FROM (...)
     WHERE us.user_id = ranked.user_id`
  );
}
```

**–°—Ç–∞–ª–æ:**
```javascript
async updateRankings() {
  try {
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ —Ç–∞–±–ª–∏—Ü–∞ user_stats
    const tableExists = await query(
      `SELECT EXISTS (
        SELECT FROM information_schema.tables 
        WHERE table_schema = 'public' 
        AND table_name = 'user_stats'
      )`
    );
    
    if (!tableExists.rows[0].exists) {
      console.warn('Table user_stats does not exist, skipping rankings update');
      return;
    }
    
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ –∑–∞–ø–∏—Å–∏ –≤ —Ç–∞–±–ª–∏—Ü–µ
    const countResult = await query(`SELECT COUNT(*) as count FROM user_stats WHERE games_played > 0`);
    if (parseInt(countResult.rows[0].count) === 0) {
      console.warn('No users with games_played > 0, skipping rankings update');
      return;
    }
    
    // –û–±–Ω–æ–≤–ª—è–µ–º —Ä–µ–π—Ç–∏–Ω–≥–∏
    await query(`UPDATE user_stats us ...`);
    
    console.log('Rankings updated successfully');
  } catch (error) {
    console.error('Error updating rankings:', error);
    // –ù–ï –ø—Ä–æ–±—Ä–∞—Å—ã–≤–∞–µ–º –æ—à–∏–±–∫—É, —á—Ç–æ–±—ã –Ω–µ –ø–∞–¥–∞–ª–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
  }
}
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã –ø–µ—Ä–µ–¥ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º
- ‚úÖ –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –Ω–∞–ª–∏—á–∏–µ –∑–∞–ø–∏—Å–µ–π –ø–µ—Ä–µ–¥ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º
- ‚úÖ –û—à–∏–±–∫–∏ –Ω–µ –ø—Ä–æ–±—Ä–∞—Å—ã–≤–∞—é—Ç—Å—è, –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ –ø–∞–¥–∞–µ—Ç
- ‚úÖ –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

---

### 2. –£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –≤ `finishTournament`

**–§–∞–π–ª:** `server/models/Game.js`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**

1. **–£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ `updateRankings`:**
```javascript
// –û–±–Ω–æ–≤–ª—è–µ–º —Ä–µ–π—Ç–∏–Ω–≥–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –º–æ–∂–µ—Ç –Ω–µ —Ä–∞–±–æ—Ç–∞—Ç—å –µ—Å–ª–∏ —Ç–∞–±–ª–∏—Ü–∞ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç)
// –í–ê–ñ–ù–û: –û–±–µ—Ä–Ω—É—Ç–æ –≤ try-catch, —á—Ç–æ–±—ã –Ω–µ –ø–∞–¥–∞–ª–æ –≤—Å–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
try {
  const { default: User } = await import('./User.js');
  if (User && User.updateRankings) {
    await User.updateRankings();
    console.log('Rankings updated successfully');
  } else {
    console.warn('User.updateRankings not available, skipping rankings update');
  }
} catch (rankingsError) {
  console.warn('Error updating rankings (non-critical):', rankingsError.message);
  console.warn('Rankings error stack:', rankingsError.stack);
  // –ù–ï –ø—Ä–æ–±—Ä–∞—Å—ã–≤–∞–µ–º –æ—à–∏–±–∫—É –¥–∞–ª—å—à–µ, —á—Ç–æ–±—ã –Ω–µ –ø–∞–¥–∞–ª–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
}
```

2. **–£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –≤ catch –±–ª–æ–∫–µ:**
```javascript
} catch (error) {
  console.error('Error in finishTournament:', error);
  console.error('Error stack:', error.stack);
  
  // –î–∞–∂–µ –µ—Å–ª–∏ –ø—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞, –ø—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ —Å—Ç–∞—Ç—É—Å –æ–±–Ω–æ–≤–ª–µ–Ω
  // —á—Ç–æ–±—ã —Ç—É—Ä–Ω–∏—Ä –ø–æ–ø–∞–ª –≤ –∏—Å—Ç–æ—Ä–∏—é
  try {
    const checkResult = await query(
      `SELECT tournament_status FROM games WHERE id = $1`,
      [gameId]
    );
    if (checkResult.rows.length > 0 && checkResult.rows[0].tournament_status === 'finished') {
      console.log('Tournament status is finished, returning empty seating (error occurred but status is correct)');
      // –ù–ï –ø—Ä–æ–±—Ä–∞—Å—ã–≤–∞–µ–º –æ—à–∏–±–∫—É, –µ—Å–ª–∏ —Å—Ç–∞—Ç—É—Å –æ–±–Ω–æ–≤–ª–µ–Ω - —Ç—É—Ä–Ω–∏—Ä –¥–æ–ª–∂–µ–Ω –ø–æ–ø–∞—Å—Ç—å –≤ –∏—Å—Ç–æ—Ä–∏—é
      return [];
    }
  } catch (checkError) {
    console.error('Error checking tournament status:', checkError);
  }
  
  // –ü—Ä–æ–±—Ä–∞—Å—ã–≤–∞–µ–º –æ—à–∏–±–∫—É —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —Å—Ç–∞—Ç—É—Å –Ω–µ –±—ã–ª –æ–±–Ω–æ–≤–ª–µ–Ω
  throw error;
}
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –ï—Å–ª–∏ —Å—Ç–∞—Ç—É—Å –æ–±–Ω–æ–≤–ª–µ–Ω, –º–µ—Ç–æ–¥ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤ –≤–º–µ—Å—Ç–æ –æ—à–∏–±–∫–∏
- ‚úÖ –¢—É—Ä–Ω–∏—Ä –ø–æ–ø–∞–¥–∞–µ—Ç –≤ –∏—Å—Ç–æ—Ä–∏—é –¥–∞–∂–µ –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏–≥—Ä–æ–∫–æ–≤
- ‚úÖ –û—à–∏–±–∫–∏ –≤ `updateRankings` –Ω–µ –ø–∞–¥–∞—é—Ç –≤—Å–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

---

### 3. –£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –≤ —Ä–æ—É—Ç–µ

**–§–∞–π–ª:** `server/routes/games.js`

**–ë—ã–ª–æ:**
```javascript
catch (error) {
  console.error('Error finishing tournament:', error);
  res.status(500).json({ error: error.message || 'Internal server error' });
}
```

**–°—Ç–∞–ª–æ:**
```javascript
catch (error) {
  console.error('Error finishing tournament:', error);
  console.error('Error stack:', error.stack);
  
  // –í–ê–ñ–ù–û: –í—Å–µ–≥–¥–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –æ—Ç–≤–µ—Ç, –¥–∞–∂–µ –ø—Ä–∏ –æ—à–∏–±–∫–µ
  // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –æ–±–Ω–æ–≤–ª–µ–Ω –ª–∏ —Å—Ç–∞—Ç—É—Å —Ç—É—Ä–Ω–∏—Ä–∞
  try {
    const checkResult = await Game.getById(gameId);
    if (checkResult && checkResult.tournament_status === 'finished') {
      // –°—Ç–∞—Ç—É—Å –æ–±–Ω–æ–≤–ª–µ–Ω - —Ç—É—Ä–Ω–∏—Ä –¥–æ–ª–∂–µ–Ω –ø–æ–ø–∞—Å—Ç—å –≤ –∏—Å—Ç–æ—Ä–∏—é
      console.log('Tournament status is finished, returning success despite error');
      return res.json({ 
        message: 'Tournament finished (some errors occurred during processing)', 
        results: [],
        warning: 'Some players may not have been processed correctly'
      });
    }
  } catch (checkError) {
    console.error('Error checking tournament status in route:', checkError);
  }
  
  // –ï—Å–ª–∏ —Å—Ç–∞—Ç—É—Å –Ω–µ –æ–±–Ω–æ–≤–ª–µ–Ω, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –æ—à–∏–±–∫—É
  res.status(500).json({ 
    error: error.message || 'Internal server error',
    details: 'Tournament may not have been finished correctly'
  });
}
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –í—Å–µ–≥–¥–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –æ—Ç–≤–µ—Ç, –¥–∞–∂–µ –ø—Ä–∏ –æ—à–∏–±–∫–µ
- ‚úÖ –ï—Å–ª–∏ —Å—Ç–∞—Ç—É—Å –æ–±–Ω–æ–≤–ª–µ–Ω, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è —É—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç
- ‚úÖ –¢—É—Ä–Ω–∏—Ä –ø–æ–ø–∞–¥–∞–µ—Ç –≤ –∏—Å—Ç–æ—Ä–∏—é –¥–∞–∂–µ –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
- ‚úÖ –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

---

## üìä –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã

### –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ç—É—Ä–Ω–∏—Ä–∞ (—É–ª—É—á—à–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è):

1. **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ (–ü–ï–†–í–´–ú):**
   - ‚úÖ `tournament_status` ‚Üí 'finished'
   - ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ø–µ—à–Ω–æ—Å—Ç–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
   - ‚úÖ –¢—É—Ä–Ω–∏—Ä —Å—Ä–∞–∑—É –ø–æ–ø–∞–¥–∞–µ—Ç –≤ –∏—Å—Ç–æ—Ä–∏—é

2. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–≥—Ä–æ–∫–æ–≤:**
   - ‚úÖ –î–ª—è –∫–∞–∂–¥–æ–≥–æ –∏–≥—Ä–æ–∫–∞ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
   - ‚úÖ –û–±–Ω–æ–≤–ª—è–µ—Ç—Å—è —Å—Ç–∞—Ç—É—Å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
   - ‚úÖ –û—à–∏–±–∫–∏ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –æ–¥–Ω–æ–≥–æ –∏–≥—Ä–æ–∫–∞ –Ω–µ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É –¥—Ä—É–≥–∏—Ö

3. **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–µ–π—Ç–∏–Ω–≥–æ–≤:**
   - ‚úÖ –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã `user_stats`
   - ‚úÖ –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –Ω–∞–ª–∏—á–∏–µ –∑–∞–ø–∏—Å–µ–π
   - ‚úÖ –û–±–Ω–æ–≤–ª—è—é—Ç—Å—è —Ä–µ–π—Ç–∏–Ω–≥–∏
   - ‚úÖ –û—à–∏–±–∫–∏ –Ω–µ –ø—Ä–æ–±—Ä–∞—Å—ã–≤–∞—é—Ç—Å—è, –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ –ø–∞–¥–∞–µ—Ç

4. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:**
   - ‚úÖ –ï—Å–ª–∏ –ø—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞, –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è —Å—Ç–∞—Ç—É—Å —Ç—É—Ä–Ω–∏—Ä–∞
   - ‚úÖ –ï—Å–ª–∏ —Å—Ç–∞—Ç—É—Å 'finished', –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è —É—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç
   - ‚úÖ –¢—É—Ä–Ω–∏—Ä –æ—Å—Ç–∞–µ—Ç—Å—è –≤ –∏—Å—Ç–æ—Ä–∏–∏
   - ‚úÖ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ –ø–∞–¥–∞–µ—Ç

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ç—É—Ä–Ω–∏—Ä–∞:

1. ‚úÖ –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –Ω–∞–∂–∏–º–∞–µ—Ç "–ó–∞–≤–µ—Ä—à–∏—Ç—å —Ç—É—Ä–Ω–∏—Ä"
2. ‚úÖ –¢—É—Ä–Ω–∏—Ä –¥–æ–ª–∂–µ–Ω —É—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à–∏—Ç—å—Å—è
3. ‚úÖ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –ø—Ä–æ–¥–æ–ª–∂–∞—Ç—å —Ä–∞–±–æ—Ç–∞—Ç—å
4. ‚úÖ –¢—É—Ä–Ω–∏—Ä –¥–æ–ª–∂–µ–Ω –ø–æ—è–≤–∏—Ç—å—Å—è –≤ –∏—Å—Ç–æ—Ä–∏–∏

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ **–ù–ï –ø–∞–¥–∞–µ—Ç**
- ‚úÖ –¢—É—Ä–Ω–∏—Ä —É—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è
- ‚úÖ –¢—É—Ä–Ω–∏—Ä –ø–æ—è–≤–ª—è–µ—Ç—Å—è –≤ –∏—Å—Ç–æ—Ä–∏–∏
- ‚úÖ –û—á–∫–∏ –Ω–∞—á–∏—Å–ª—è—é—Ç—Å—è –∏–≥—Ä–æ–∫–∞–º (–µ—Å–ª–∏ —Ç–∞–±–ª–∏—Ü–∞ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç)
- ‚úÖ –†–µ–π—Ç–∏–Ω–≥–∏ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è (–µ—Å–ª–∏ —Ç–∞–±–ª–∏—Ü–∞ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç)

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏:

1. ‚úÖ –û—Ç–∫—Ä–æ–π—Ç–µ –≤–∫–ª–∞–¥–∫—É "–ò—Å—Ç–æ—Ä–∏—è"
2. ‚úÖ –ù–∞–π–¥–∏—Ç–µ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–π —Ç—É—Ä–Ω–∏—Ä
3. ‚úÖ –û—Ç–∫—Ä–æ–π—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç—É—Ä–Ω–∏—Ä–∞

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –¢—É—Ä–Ω–∏—Ä –≤–∏–¥–µ–Ω –≤ –∏—Å—Ç–æ—Ä–∏–∏
- ‚úÖ –ü–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –≤—Å–µ —É—á–∞—Å—Ç–Ω–∏–∫–∏
- ‚úÖ –ü–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –º–µ—Å—Ç–∞ –∏ –æ—á–∫–∏

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–π—Ç–∏–Ω–≥–∞:

1. ‚úÖ –û—Ç–∫—Ä–æ–π—Ç–µ –≤–∫–ª–∞–¥–∫—É "–†–µ–π—Ç–∏–Ω–≥"
2. ‚úÖ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –æ—á–∫–∏ –Ω–∞—á–∏—Å–ª–µ–Ω—ã

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –û—á–∫–∏ –Ω–∞—á–∏—Å–ª–µ–Ω—ã (–µ—Å–ª–∏ —Ç–∞–±–ª–∏—Ü–∞ `user_stats` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç)
- ‚úÖ –†–µ–π—Ç–∏–Ω–≥–∏ –æ–±–Ω–æ–≤–ª–µ–Ω—ã (–µ—Å–ª–∏ —Ç–∞–±–ª–∏—Ü–∞ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç)

---

## üìÅ –ò–∑–º–µ–Ω–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

1. ‚úÖ `server/models/User.js`
   - `updateRankings()` - –¥–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü—ã
   - –û—à–∏–±–∫–∏ –Ω–µ –ø—Ä–æ–±—Ä–∞—Å—ã–≤–∞—é—Ç—Å—è

2. ‚úÖ `server/models/Game.js`
   - `finishTournament()` - —É–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
   - –ï—Å–ª–∏ —Å—Ç–∞—Ç—É—Å –æ–±–Ω–æ–≤–ª–µ–Ω, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è —É—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç

3. ‚úÖ `server/routes/games.js`
   - –£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –≤ —Ä–æ—É—Ç–µ `/finish`
   - –í—Å–µ–≥–¥–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –æ—Ç–≤–µ—Ç

---

## üéØ –°—Ç–∞—Ç—É—Å: –ì–û–¢–û–í–û!

‚úÖ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ –ø–∞–¥–∞–µ—Ç –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ç—É—Ä–Ω–∏—Ä–∞  
‚úÖ –¢—É—Ä–Ω–∏—Ä –ø–æ–ø–∞–¥–∞–µ—Ç –≤ –∏—Å—Ç–æ—Ä–∏—é –¥–∞–∂–µ –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö  
‚úÖ –û—á–∫–∏ –Ω–∞—á–∏—Å–ª—è—é—Ç—Å—è –∏–≥—Ä–æ–∫–∞–º (–µ—Å–ª–∏ —Ç–∞–±–ª–∏—Ü–∞ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç)  
‚úÖ –†–µ–π—Ç–∏–Ω–≥–∏ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è (–µ—Å–ª–∏ —Ç–∞–±–ª–∏—Ü–∞ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç)  
‚úÖ –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏  

---

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- –°—Ç–∞—Ç—É—Å —Ç—É—Ä–Ω–∏—Ä–∞ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –ü–ï–†–í–´–ú, —á—Ç–æ–±—ã –æ–Ω –ø–æ–ø–∞–ª –≤ –∏—Å—Ç–æ—Ä–∏—é –¥–∞–∂–µ –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
- –û—à–∏–±–∫–∏ –≤ `updateRankings` –Ω–µ –ø–∞–¥–∞—é—Ç –≤—Å–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
- –û—à–∏–±–∫–∏ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –∏–≥—Ä–æ–∫–æ–≤ –Ω–µ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç –≤–µ—Å—å –ø—Ä–æ—Ü–µ—Å—Å
- –ï—Å–ª–∏ —Å—Ç–∞—Ç—É—Å –æ–±–Ω–æ–≤–ª–µ–Ω, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è —É—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç, –¥–∞–∂–µ –µ—Å–ª–∏ –±—ã–ª–∏ –æ—à–∏–±–∫–∏

---

**–ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ –±—É–¥–µ—Ç –ø–∞–¥–∞—Ç—å –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ç—É—Ä–Ω–∏—Ä–∞! üéâ**

