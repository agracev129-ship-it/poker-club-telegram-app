# ‚úÖ –§–ò–ù–ê–õ–¨–ù–û–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï - –ú–æ–¥–µ—Ä–∞—Ü–∏—è –ø—Ä–æ—Ñ–∏–ª–µ–π

## üéØ –ù–∞–π–¥–µ–Ω–∞ –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞!

### –ß—Ç–æ –±—ã–ª–æ:

**–°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞ —Ä–∞–±–æ—Ç–∞–ª–æ ‚úÖ**
- –ó–∞–ø—Ä–æ—Å —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–≤–∞–ª—Å—è –≤ –ë–î
- ID: 4, userId: 94
- –ó–∞–ø–∏—Å—å —Å–æ—Ö—Ä–∞–Ω—è–ª–∞—Å—å

**–ù–û! –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–ª–∞ –∑–∞—è–≤–∫–∏ ‚ùå**
- –û—à–∏–±–∫–∞: `column u.avatar_url does not exist`
- –ü—Ä–æ–∏—Å—Ö–æ–¥–∏–ª–æ –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –ø–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫

### –ü—Ä–∏—á–∏–Ω–∞:

**–ù–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –∏–º–µ–Ω –ø–æ–ª–µ–π –≤ SQL –∑–∞–ø—Ä–æ—Å–∞—Ö:**

–í —Ç–∞–±–ª–∏—Ü–µ `users`:
```sql
photo_url TEXT  -- ‚Üê –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏–º—è –ø–æ–ª—è
```

–í SQL –∑–∞–ø—Ä–æ—Å–µ `ProfileRequest.getAll()`:
```sql
u.avatar_url as user_avatar_url  -- ‚Üê –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏–º—è!
```

PostgreSQL –Ω–µ –º–æ–≥ –Ω–∞–π—Ç–∏ –ø–æ–ª–µ `avatar_url` –∏ –≤—ã–¥–∞–≤–∞–ª –æ—à–∏–±–∫—É.

---

## üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:

### –§–∞–π–ª: `server/models/ProfileRequest.js`

**–°—Ç—Ä–æ–∫–∞ 31 - –º–µ—Ç–æ–¥ `getAll()`:**
```javascript
// –ë–´–õ–û:
u.avatar_url as user_avatar_url

// –°–¢–ê–õ–û:
u.photo_url as user_avatar_url
```

**–°—Ç—Ä–æ–∫–∞ 56 - –º–µ—Ç–æ–¥ `getById()`:**
```javascript
// –ë–´–õ–û:
u.avatar_url as user_avatar_url

// –°–¢–ê–õ–û:
u.photo_url as user_avatar_url
```

---

## üìã –ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å:

### –î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
```javascript
static async getAll(status = null) {
  let query = `
    SELECT 
      pcr.*,
      u.name as user_name,
      u.telegram_id,
      u.avatar_url as user_avatar_url  ‚Üê –û–®–ò–ë–ö–ê!
    FROM profile_change_requests pcr
    JOIN users u ON pcr.user_id = u.id
  `;
  // ...
}
```

### –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
```javascript
static async getAll(status = null) {
  let query = `
    SELECT 
      pcr.*,
      u.name as user_name,
      u.telegram_id,
      u.photo_url as user_avatar_url  ‚Üê –ò–°–ü–†–ê–í–õ–ï–ù–û!
    FROM profile_change_requests pcr
    JOIN users u ON pcr.user_id = u.id
  `;
  // ...
}
```

---

## ‚úÖ –¢–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç:

1. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏–∑–º–µ–Ω—è–µ—Ç –∏–º—è:**
   - –§–æ—Ä–º–∞ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è ‚úÖ
   - –î–∞–Ω–Ω—ã–µ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä ‚úÖ
   - –ó–∞–ø–∏—Å—å —Å–æ–∑–¥–∞–µ—Ç—Å—è –≤ –ë–î ‚úÖ
   - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç success —Å–æ–æ–±—â–µ–Ω–∏–µ ‚úÖ

2. **–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∑–∞—è–≤–∫–∏:**
   - –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å ‚Üí –ú–æ–¥–µ—Ä–∞—Ü–∏—è –ø—Ä–æ—Ñ–∏–ª–µ–π ‚úÖ
   - –°–ø–∏—Å–æ–∫ –∑–∞—è–≤–æ–∫ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –ë–ï–ó –æ—à–∏–±–æ–∫ ‚úÖ
   - –û—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤—Å–µ pending –∑–∞—è–≤–∫–∏ ‚úÖ
   - –ú–æ–∂–Ω–æ –æ–¥–æ–±—Ä–∏—Ç—å/–æ—Ç–∫–ª–æ–Ω–∏—Ç—å ‚úÖ

3. **–ü–æ—Å–ª–µ –æ–¥–æ–±—Ä–µ–Ω–∏—è:**
   - –ü–æ–ª–µ `name` –≤ —Ç–∞–±–ª–∏—Ü–µ `users` –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è ‚úÖ
   - –ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–æ–≤–æ–µ –∏–º—è ‚úÖ

---

## üöÄ –î–µ–ø–ª–æ–π:

```bash
git add .
git commit -m "Fix: –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –ø–æ–ª–µ–π avatar_url ‚Üí photo_url"
git push origin main
```

Render –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–¥–µ–ø–ª–æ–∏—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è.

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:

### –®–∞–≥ 1: –û—á–∏—Å—Ç–∏—Ç—å —Å—Ç–∞—Ä—ã–µ –∑–∞—è–≤–∫–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
–ï—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ –Ω–∞—á–∞—Ç—å —Å —á–∏—Å—Ç–æ–≥–æ –ª–∏—Å—Ç–∞:
```sql
-- –í Render Dashboard ‚Üí PostgreSQL
DELETE FROM profile_change_requests WHERE status = 'pending';
```

### –®–∞–≥ 2: –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –∑–∞—è–≤–∫—É
1. –û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∫–∞–∫ –æ–±—ã—á–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
2. –ü—Ä–æ—Ñ–∏–ª—å ‚Üí –ö–Ω–æ–ø–∫–∞ ‚úèÔ∏è
3. –í–≤–µ–¥–∏—Ç–µ –Ω–æ–≤–æ–µ –∏–º—è
4. –ù–∞–∂–º–∏—Ç–µ "–û—Ç–ø—Ä–∞–≤–∏—Ç—å –Ω–∞ –º–æ–¥–µ—Ä–∞—Ü–∏—é"
5. **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
   - Toast: "–ó–∞–ø—Ä–æ—Å –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω"
   - –§–æ—Ä–º–∞ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è

### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª–∏
1. –û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∫–∞–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä
2. Admin Mode ‚Üí –ú–æ–¥–µ—Ä–∞—Ü–∏—è –ø—Ä–æ—Ñ–∏–ª–µ–π
3. **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
   - –ó–∞—è–≤–∫–∞ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ —Å–ø–∏—Å–∫–µ
   - –í–∏–¥–Ω–æ —Ç–µ–∫—É—â–µ–µ –∏ –Ω–æ–≤–æ–µ –∏–º—è
   - –°—á–µ—Ç—á–∏–∫ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞—è–≤–æ–∫
   - **–ë–ï–ó –û–®–ò–ë–û–ö!**

### –®–∞–≥ 4: –û–¥–æ–±—Ä–∏—Ç—å –∑–∞—è–≤–∫—É
1. –ù–∞–∂–º–∏—Ç–µ "–ü—Ä–∏–Ω—è—Ç—å"
2. **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
   - –ó–∞—è–≤–∫–∞ –∏—Å—á–µ–∑–∞–µ—Ç –∏–∑ —Å–ø–∏—Å–∫–∞
   - –ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è
   - –ù–æ–≤–æ–µ –∏–º—è –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤–µ–∑–¥–µ

---

## üìä –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö:

```sql
-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–∑–¥–∞–Ω–Ω—ã–µ –∑–∞—è–≤–∫–∏
SELECT 
  pcr.id,
  pcr.user_id,
  pcr.current_name,
  pcr.requested_name,
  pcr.status,
  u.name as user_name,
  u.photo_url
FROM profile_change_requests pcr
JOIN users u ON pcr.user_id = u.id
ORDER BY pcr.created_at DESC;
```

–î–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å:
```
id | user_id | current_name | requested_name | status  | user_name | photo_url
---|---------|--------------|----------------|---------|-----------|----------
4  | 94      | t v          | Test           | pending | t v       | https://...
```

---

## üéâ –ì–æ—Ç–æ–≤–æ!

**–í—Å–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
- ‚úÖ –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–∞ —É—Ä–æ–≤–Ω–µ API
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–∞ –º–æ–¥–µ—Ä–∞—Ü–∏—é
- ‚úÖ –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∑–∞—è–≤–æ–∫ –≤ –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª–∏
- ‚úÖ –û–¥–æ–±—Ä–µ–Ω–∏–µ/–æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –∑–∞—è–≤–æ–∫
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è –ø–æ—Å–ª–µ –æ–¥–æ–±—Ä–µ–Ω–∏—è

**–ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ! üöÄ**

---

## üìû –ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è:
1. **Render ‚Üí Backend ‚Üí Logs**
2. **–ù–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –æ—à–∏–±–æ–∫ –æ `avatar_url`**
3. **–î–æ–ª–∂–Ω–æ –±—ã—Ç—å: "Profile request created successfully"**

–ï—Å–ª–∏ –µ—Å—Ç—å –¥—Ä—É–≥–∏–µ –æ—à–∏–±–∫–∏ - –ø—Ä–∏—à–ª–∏—Ç–µ –ª–æ–≥–∏!

